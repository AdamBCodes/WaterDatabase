{% extends "base.html" %}
{% block title %}Add Address{% endblock %}
{% block content %}
    <script>
        
        var loadFile = function(event) {
            var reader = new FileReader();
            reader.onload = function(){
                var output = document.getElementById('output');
                output.src = reader.result;
            };
            reader.readAsDataURL(event.target.files[0]);
        };

        var loadStreets = function(event, streets) {
            parent = document.querySelector("#street")
            keeper = parent.firstElementChild
            console.log(keeper)
            parent.innerHTML = ''
            parent.appendChild(keeper)
            value = document.getElementById("city").value
            length = Object.keys(streets).length
            for(var s=0; s<length; s++){
                console.log(streets[s][1])
                if(streets[s][1] === value){
                    option = document.createElement('option')
                    option.textContent+=streets[s][0]
                    parent.appendChild(option)
                }
            }       
        };
    </script>
    <form method="POST" enctype="multipart/form-data">
        <img id="output" style="width: 20%; height: 20%;"/>
        <input type="text" name="streetnum" placeholder="Street Number" required />
        <select id="city" name="city" onchange="loadStreets(event, {{ streetData }})">
            {% for c in allCities %}
                <option> {{ c.name }}</option>
            {% endfor %}
        </select>
        <select id="street" name="street" required>
            <option disabled selected value> -- Select A Street -- </option>
            {% for s in allStreets %}
                <option>{{ s.name }}</option>
            {% endfor %}
        </select>
        <input type="text" name="meterNum" placeholder="Meter Number" />
        <input type="text" name="meterSize" placeholder="Meter Size" />
        <input type="text" name="tieOne" placeholder="Tie 1"/>
        <input type="text" name="tieTwo" placeholder="Tie2"/>
        <textarea name="notes" placeholder="Notes..."></textarea>
        <input type="file" name="img" onchange="loadFile(event)" accept="image/*"/>
        <input type="submit" value="Create Address" />
    </form>
    {{message}}
{% endblock %}